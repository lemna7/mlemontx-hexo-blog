---
title: åŠ è½½åŠ¨ç”»
date: 2023/03/01
tags:
  - é™æ€åšå®¢
categories:
  - æŠ€æœ¯
  - é™æ€åšå®¢
top_img: https://s2.loli.net/2023/03/04/ZrjCm81ywWDK5PL.webp
cover: https://s2.loli.net/2023/03/04/ZrjCm81ywWDK5PL.webp
---

## å‚è€ƒæ¥æº

[å®‰ä¹‹é±¼ | HeoåŒæ¬¾loadingåŠ¨ç”»](https://anzhiy.cn/posts/52d8.html)

## æ•ˆæœé¢„è§ˆ

![åŠ è½½åŠ¨ç”»-æ•ˆæœé¢„è§ˆ.png](https://s2.loli.net/2023/03/04/QLpo91wnT3lXOCt.png)

## ç‰ˆæœ¬
- Node: 12.13.0
- Hexo: 6.3.0
- Butterfly: 4.7.0

## æ–¹æ¡ˆ

ä¿®æ”¹ `themes/butterfly/layout/includes/loading/fullpage-loading.pug`

```text
#loading-box(onclick='document.getElementById("loading-box").classList.add("loaded")')
  .loading-bg
    div.loading-img
    .loading-image-dot

script.
  const preloader = {
    endLoading: () => {
      document.body.style.overflow = 'auto';
      document.getElementById('loading-box').classList.add("loaded")
    },
    initLoading: () => {
      document.body.style.overflow = '';
      document.getElementById('loading-box').classList.remove("loaded")

    }
  }
  window.addEventListener('load',()=> { preloader.endLoading() })

  if (!{theme.pjax && theme.pjax.enable}) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
```

ä¿®æ”¹ `themes/butterfly/layout/includes/loading/index.pug`

```text
if theme.preloader.source === 1
  include ./fullpage-loading.pug
else if theme.preloader.source === 2
  include ./pace.pug
else
  include ./fullpage-loading.pug
  include ./pace.pug
```

æ–°å»º `source/css/progress_bar.css`ï¼Œä¹Ÿå¯ä»¥ä¸åšè¿™ä¸€æ­¥ä¸‹é¢é…ç½®æ–‡ä»¶ `pace_css_url` è¿™ä¸€é¡¹å°±è¦ç•™ç©ºï¼Œ è¿™ä¸€æ­¥æ˜¯ä¿®æ”¹ pace åŠ è½½çš„èƒ¶å›Š ğŸ’Š æ ·å¼ç”¨çš„

```css
.pace {
  -webkit-pointer-events: none;
  pointer-events: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  z-index: 2000;
  position: fixed;
  margin: auto;
  top: 10px;
  left: 0;
  right: 0;
  height: 8px;
  border-radius: 8px;
  width: 4rem;
  background: #eaecf2;
  border: 1px #e3e8f7;
  overflow: hidden;
}

.pace-inactive .pace-progress {
  opacity: 0;
  transition: 0.3s ease-in;
}

.pace .pace-progress {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  -ms-box-sizing: border-box;
  -o-box-sizing: border-box;
  box-sizing: border-box;
  -webkit-transform: translate3d(0, 0, 0);
  -moz-transform: translate3d(0, 0, 0);
  -ms-transform: translate3d(0, 0, 0);
  -o-transform: translate3d(0, 0, 0);
  transform: translate3d(0, 0, 0);
  max-width: 200px;
  position: absolute;
  z-index: 2000;
  display: block;
  top: 0;
  right: 100%;
  height: 100%;
  width: 100%;
  background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
  animation: gradient 1.5s ease infinite;
  background-size: 200%;
}

.pace.pace-inactive {
  opacity: 0;
  transition: 0.3s;
  top: -8px;
}
@keyframes gradient {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}
```

ä¿®æ”¹ `themes/butterfly/source/css/_layout/loading.styl`ï¼Œæ³¨æ„å…¶ä¸­é¢œè‰²ä»£ç  `----mlemontx-theme` ç­‰éœ€è‡ªè¡Œæ›¿æ¢ä¸ºè‡ªå·±çš„è‰²å€¼

```styl
if hexo-config('preloader')
  .loading-bg
    display: flex;
    width: 100%;
    height: 100%;
    position: fixed;
    background: var(----mlemontx-theme);
    z-index: 1001;
    opacity: 1;
    transition: .3s;

  #loading-box
    .loading-img
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin: auto;
      border: 4px solid #f0f0f2;
      animation-duration: .3s;
      animation-name: loadingAction;
      animation-iteration-count: infinite;
      animation-direction: alternate;
    .loading-image-dot
      width: 30px;
      height: 30px;
      background: #6bdf8f;
      position: absolute;
      border-radius: 50%;
      border: 6px solid #fff;
      top: 50%;
      left: 50%;
      transform: translate(18px, 24px);
    &.loaded
      .loading-bg
        opacity: 0;
        z-index: -1000;

  @keyframes loadingAction
    0% {
        opacity: 1;
    }

    100% {
        opacity: .4;
    }
```

è‡ªå®šä¹‰ css æ–‡ä»¶ï¼Œå…¶ä¸­ `background` çš„ `url` å³ä¸º loading çš„å›¾ç‰‡åœ°å€

[Leonus | Hexoåšå®¢æ·»åŠ è‡ªå®šä¹‰csså’Œjsæ–‡ä»¶](https://blog.leonus.cn/2022/custom.html)

```css
.loading-img {
    background: url('//s2.loli.net/2023/03/04/aBsd12DAvGUtob9.png') no-repeat center center;
    background-size: cover;
}
```
æœ€åä¿®æ”¹ `_config.butterfly.yml` ä¸­ `preloader` é€‰é¡¹ï¼Œæ”¹å®Œä»¥å `source: 1` ä¸ºæ»¡å±åŠ è½½æ—  pace èƒ¶å›Šï¼Œ`source: 2` ä¸º pace èƒ¶å›Šæ— æ»¡å±åŠ¨ç”»ï¼Œ`source: 3` æ˜¯ä¸¤è€…éƒ½å¯ç”¨

```yml
# Loading Animation (åŠ è½½åŠ¨ç”»)
preloader:
  enable: true
  # source
  # 1. fullpage-loading
  # 2. pace (progress bar)
  # else all
  source: 3
  # pace theme (see https://codebyzach.github.io/pace/)
  pace_css_url: /css/progress_bar.css
```